# 6. Тренажер управления инвалидной коляской <a name="6"></a>

****
## 6.1 Установка и настройка инструментов для работы с Bluemix<a name="61"></a>

  Для публикации проекта в облаке IBM Bluemix необходимо:

* Зарегистрироваться в Bluemix, выбрав в качестве региона GB

* Установить Docker для локального тестирования проекта, $ bx build & run будет собирать и запускать контейнер по Dockerfile из директории проекта

### О Docker
  Docker- программное обеспечение для автоматизации развёртывания и управления приложениями в среде виртуализации на уровне операционной системы; позволяет «упаковать» приложение со всем его окружением и зависимостями в контейнер, а также предоставляет среду по управлению контейнерами.

  Простыми словами, Docker это инструмент, который позволяет разработчикам, системными администраторам и другим специалистам разворачивать их приложения в песочнице (которые называются контейнерами), для запуска на целевой операционной системе, например, Linux. Ключевое преимущество Docker в том, что он позволяет пользователям упаковать приложение со всеми его зависимостями в стандартизированный модуль для разработки, таким образом, Docker избавляет от возможных ошибок системного администратора сервера. В отличие от виртуальных машин, контейнеры не создают дополнительной нагрузки, поэтому с ними можно использовать систему и ресурсы более эффективно.
  
  * Инструкция по установке `Docker` на `Ubuntu 16.04`: https://losst.ru/ustanovka-docker-na-ubuntu-16-04

### Пошаговая инструкция
##### 1. Установка Bluemix CLI
* Скачиваем и устанавливаем Bluemix CLI (bx cli):
  ```shell
  $ tar -xvf Bluemix_CLI.tar.gz
  $ cd Bluemix_CLI
  $ sudo ./install_bluemix_cli
  ```
* Теперь нам доступны команды bx - проверим: `$ bx --version`

* Логинимся под учетной записью IBM Bluemix:
  `$ bx login`
  
* Установим `dev` пакет для `bx`: https://console.bluemix.net/docs/cloudnative/dev_cli.html#developercli
`$ curl -sL https://ibm.biz/idt-installer | bash`  
  
* Подробнее о работе с Bluemix CLI:
https://console.bluemix.net/docs/cli/reference/bluemix_cli/get_started.html#getting-started
https://console.bluemix.net/docs/cli/reference/bluemix_cli/download_cli.html#download_install

##### 2. Локальная сборка тестового проекта
* После установки `dev` пакета выбираем `Node.js` приложение из списка Starter Kit Bluemix: https://console.bluemix.net/developer/appservice/starter-kits

  Подробнее: https://console.bluemix.net/docs/cloudnative/tutorial_bff.html#code

* Нажимаем на Generate code и скачиваем архив с файлами тестового `hello world` приложения.
* Протестируем работоспособность приложения, развернув его локально. Для этого создадим и запустим контейнер:
```
bx dev build
bx dev run
```
* После этого вы сможете посмотреть результат запуска приложения в браузере: `localhost:3000`

  Выведем `hello world!` на стартовой странице приложения: в файле проекта `public/index.html` добавим
  
  `<h1> HELLO IBM! </h1>`

* Чтобы остановить контейнер: `Ctrl + С`

##### 3. Публикации проекта в облаке Bluemix
* Настроим параметры ORG и SPACE (ключи `-o` и `-s`) в `bx` в соответствии с данными в Bluemix аккаунте:
`bx target -o Brainstormv2 -s space1`

  Должно получиться что-то подобное:
`$ bx login`
```
Authenticating...
OK
...
API endpoint:     https://api.eu-gb.bluemix.net (API version: 2.75.0)   
Region:           eu-gb   
User:             akenoq@yandex.ru   
Account:          BMSTU (eb7fb19a1c1e905a97abccf90b1d2d0b)   
Resource group:   Default   
Org:                 
Space:               
Tip: If you are managing Cloud Foundry applications and services
- Use 'bx target --cf' to target Cloud Foundry org/space interactively, or use 'bx target -o ORG -s SPACE' to target the org/space.
- Use 'bx cf' if you want to run the Cloud Foundry CLI with current Bluemix CLI context.
```

`$ bx target -o Brainstormv2 -s space1`
```
Targeted org Brainstormv2
Targeted space space1
                     
API endpoint:     https://api.eu-gb.bluemix.net (API version: 2.75.0)   
Region:           eu-gb   
User:             akenoq@yandex.ru   
Account:          BMSTU (eb7fb19a1c1e905a97abccf90b1d2d0b)   
Resource group:   Default   
Org:              Brainstormv2   
Space:            space1   
```
`$ bx dev deploy`

* Результат публикации можно посмотреть, перейдя по ссылке на ваше приложение. Ссылку можно найти в панели управления приложениями `Dashboard`: https://console.bluemix.net/dashboard/

##### 4. Создание своего проекта
* Теперь попробуем опубликовать свое приложение.
  Заменим все директории со статикой в директории скачанного примера на свои, в примере ниже папка static
  + заменим package.json и webpack.config.js
  
  Пример package.json без сборobrf webpack:
  ```
  {
  "name": "socket-server",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "express": "^4.16.2",
    "http": "0.0.0",
    "request": "^2.83.0",
    "ws": "^3.3.1"
  }
  ``` 
  
  
  Пример содержимого в директории с готовым к развертыванию проектом:
`
ibm-project$ ls -1

cli-config.yml
Dockerfile
Dockerfile-tools
idt.js
index.js
LICENSE
manifest.yml
node_modules
node_modules_linux
package.json
README.md
RELEASE
static
webpack.config.js
`

* Проверим локально корректность получившегося проекта:
```
bx dev build
bx dev run
```
* Публикуем в облаке:
```
bx dev deploy
```
****
## 6.2 Работа с 3D-тренажером <a name="62"></a>

1. Скачиваем архив: https://github.com/maxim218/Socket_And_Client_3dWorld/

  * Директория world3D - сокет-клиент 3D-тренажер
  
    => вы можете опубликовать его в своем Bluemix, следуя инструкции 6.1
  
    => тестовый 3D-тренажер доступен по ссылке: https://3d-world-ws-host.eu-gb.mybluemix.net/
    
  * Директория NodeSocket - сокет-сервер, который будет расположен на вашем локальном компьютере. Да-да, это новый тренд :)
  
    => для его запуска необходимо выполнить команды: `npm install` - для подгрузки зависимостей и `node index.js` для запуска сервера на `localhost:5007`
 2. Управление
 
    Управляющие сигналы в формате `W`, `A`, `S`, `D` + `__` ваша программа распознвания должна писать в файл keysFile.txt (сейчас там есть тестовый клиент Qt SignalsSender) => данные из этого файла по сокет-соединению передаются на 3D-тренажер.
    
    Примеры данных в файле: `W__`, `A__` или одноременно `WA__`
 
****
## //ToDo <a name="63"></a>

